# Creating JPO/Micropython stubs for VS Code

## Purpose
VS Code editor (through Pylance and Pylint extensions) provides features like autocomplete, error checking and tooltips for Python code. 

Since the JPO/Micropython is different from CPython, VS Code needs stubs to tell it about available functionality, such as Python modules and builtins. 

## How to create stubs

1. Install the `stubber` tool, if it's not already present. In the Admin command prompt, run:
    ```
    pip install -U micropython-stubber
    ```

2. Run `generate-stubs.cmd` to use the `stubber` tool to create stubs based on the current Micropython repository.
   * First run should be in Admin command prompt, to create symlinks. 
   * In case of the "bad credentials" error, install `stubber` again (see above), even if it's already prsent. 

3. Manually update `modules.txt file:
    1. run `help("modules")` inside the JPO/Micropython REPL
    2. copy the output and paste into `modules.txt` under the `// Paste output below` line.

4. Run `copy-stubs.cmd` to copy the relevant stubs into `%JPO_PATH%\resources\py_stubs`. It will:
    - copy the stubs corresponding to modules into the `py_stubs\rp2` folder
    - create empty .py files in the `py_stubs\pylint` folder

5. Stubs in `py_stubs\manual` were not generated by the tools, and should be manually edited. Review. 

6. Subs in `py_stubs\stdlib` folder are retrieved from and then manually edited. To update:
    1. Retrieve from [micropython-stubs](https://github.com/Josverl/micropython-stubs) by doing:
        ```
        pip install -U micropython-rp2-pico-stubs --no-user --target=typing
        ```
    2. Copy the files to `py_stubs\stdlib`

    3. Make manual changes to adapt to JPO/Micropython

## How to use stubs
Press F1 and run the "Add Starter Code" command.

This is part of the JPO tools VS Code extension.
